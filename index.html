<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta name="google-site-verification" content="bsz625Fk5LhSKZGojTuJJJlIHvAT9ZvfBSmM2akWRZw" />
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
 <!-- ØµÙˆØ±Ø© Ù…ØµØºÙ‘Ø±Ø© Ø¹Ù†Ø¯ Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…ÙˆÙ‚Ø¹ -->
<meta property="og:title" content="Ù…ØªØ¬Ø± Ø§Ù„ÙƒØªØ±Ø±ÙˆÙ†ÙŠ Ø®Ø§Øµ Ø¨Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø§Ù†ØªØ±Ù†Øª ÙˆØ´Ø­Ù† Ø§Ù„Ø§Ø±ØµØ¯Ù‡"> 
<meta property="og:description" content="+994401888888 Ø§Ù‡Ù„Ø§ ÙˆØ³Ù‡Ù„Ø§ Ø¨ÙƒÙ…  ÙÙŠ Ù…ÙˆÙ‚Ø¹Ù†Ø§ Ø§Ù„Ù…ØªÙˆØ§Ø¶Ø¹ Ù‚Ù… Ø¨ØªÙØ¹ÙŠÙ„ ÙÙŠ Ø¨ÙŠ Ø§Ù† Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„ÙŠ Ù…ÙˆÙ‚Ø¹Ù†Ø§ Ù…ØªÙˆØ§Ø¬Ø¯ Ø´Ø­Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª ÙˆØ§Ù„Ø§Ø±ØµØ¯Ù‡ Ù„Ø´Ø­Ù† Ù…ÙˆÙ‚Ø¹Ùƒ Ø§Ù„Ø®Ø§Øµ Ø§Ùˆ Ø§Ù„Ø³ØªÙØ³Ø§Ø± ØªÙˆØ§ØµÙ„ Ø¹ ÙˆØ§ØªØ³Ø§Ø¨ ">
<meta property="og:image" content="https://a.top4top.io/p_3547wy24w1.jpg">
<meta property="og:url" content="https://example.com">
<meta property="og:type" content="website">

<!-- Ø¯Ø¹Ù… ØªÙˆÙŠØªØ± -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Ù…ØªØ¬Ø± Ø§Ù„ÙƒØªØ±Ø±ÙˆÙ†ÙŠ Ø®Ø§Øµ Ø¨Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø§Ù†ØªØ±Ù†Øª ÙˆØ´Ø­Ù† Ø§Ù„Ø§Ø±ØµØ¯Ù‡"> 
<meta name="twitter:description" content="+994401888888 Ø«Ù… Ù‚Ù… Ø¨Ø¹Ù…Ù„ Ø§Ù…ÙŠÙ„ ÙˆÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø®Ø§ØµÙ‡ Ø¨Ùƒ Ø§Ø­ØªÙØ¶ Ø¨Ù‡Ù… Ù„ØªØ³Ø·ØªÙŠØ¹ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù…Ø±Ù‡ Ø§Ø®Ø±Ù‡  Ù„Ø´Ø­Ù† Ø±ØµÙŠØ¯ Ø¹ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ùˆ Ø§ÙŠØª Ø§Ø³ØªÙØ³Ø§Ø± ØªÙˆØ§ØµØ¹ Ø¹  Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ§Ù„ÙŠ   vpnØ§Ù‡Ù„Ø§ Ø¨ÙƒÙ… Ø·Ø±ÙŠÙ‚Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„ÙŠ Ø§Ù„Ù…ÙˆÙ‚Ø¹  ÙØ¹Ù„ ØªØ·Ø¨ÙŠÙ‚">
<meta name="twitter:image" content="https://a.top4top.io/p_3547wy24w1.jpg">


<link rel="icon" href="https://d.top4top.io/p_35542p6un1.jpg"> 
  <title> Ù…ØªØ¬Ø± Ø§Ø±ØµØ¯Ø§</title>
  <meta hame="description" content="ÙƒÙ„ Ù…Ø§  html css js ÙŠØ®Øµ ØªØ±Ø¨ÙŠØª Ø§Ù„Ù†Ø­Ù„ ÙˆØ§Ù„Ø¨Ø±Ù…Ø¬Ù‡ " />
<meta name="google-site-verification" content="imSnWzbUrQlVqsI_Yxk4i2Buh_yyjBnwsDtFC2EXjGc" />
  <urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9" xmlns:xhtml="http://www.w3.org/1999/xhtml">

  <!-- Ø§Ù„ÙˆØµÙ -->
  <meta name="description" content="Ù…ØªØ¬Ø± ÙŠÙˆØ³Ù ÙŠÙ‚Ø¯Ù… Ø¬Ù…ÙŠØ¹ Ø£Ù†ÙˆØ§Ø¹ Ø´Ø­Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª ÙˆØ§Ù„Ø®Ø·ÙˆØ· ÙˆØ§Ù„Ø£Ù„Ø¹Ø§Ø¨. Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„: Ø´ØºÙ‘Ù„ VPNØŒ Ø£Ø¶Ù Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±ØŒ Ø«Ù… Ø§Ø¶ØºØ· ØªØ³Ø¬ÙŠÙ„. Ù„Ù„ØªÙˆØ§ØµÙ„ ÙˆØ´Ø­Ù† Ø§Ù„Ø±ØµÙŠØ¯: ÙˆØ§ØªØ³Ø§Ø¨ +994401888888">

  <!-- Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ© -->
  <meta name="keywords" content="Ù…ØªØ¬Ø± ÙŠÙˆØ³Ù, Ù…ØªØ¬Ø± Ù‚ÙŠØ§Ø¯Ù‡, Ù…ØªØ¬Ø± XIX, Ù…ØªØ¬Ø± Ø§Ù„ÙƒØªØ±ÙˆÙ†ÙŠ, Ù…ØªØ¬Ø± Ø§Ù„Ø¹Ø§Ø¨, Ù…ØªØ¬Ø± ØªØ·Ø¨ÙŠÙ‚Ø§Øª, Ø´Ø­Ù† Ø§Ù„Ø¹Ø§Ø¨, Ø´Ø­Ù† ØªØ·Ø¨ÙŠÙ‚Ø§Øª, Ø´Ø­Ù† Ø¨Ø¨Ø¬ÙŠ, Ø´Ø­Ù† ÙØ±ÙŠ ÙØ§ÙŠØ±, Ø³Ø±ÙŠØªÙŠÙ„, Ø§Ù… ØªÙŠ Ø§Ù†">

  <!-- ØªØ¹Ù„ÙŠÙ…Ø§Øª Ù„Ù…Ø­Ø±ÙƒØ§Øª Ø§Ù„Ø¨Ø­Ø« -->
  <meta name="robots" content="index, follow">
  <meta name="author" content="Ù…ØªØ¬Ø± ÙŠÙˆØ³Ù">

  <!-- Open Graph (Ù„Ø¸Ù‡ÙˆØ± Ø§Ù„ØµÙˆØ±Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©) -->
  <meta property="og:title" content="Ù…ØªØ¬Ø± ÙŠÙˆØ³Ù | Ù…ØªØ¬Ø± XIX">
  <meta property="og:description" content="Ù…ØªØ¬Ø± ÙŠÙˆØ³Ù ÙŠÙ‚Ø¯Ù… Ø¬Ù…ÙŠØ¹ Ø£Ù†ÙˆØ§Ø¹ Ø´Ø­Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª ÙˆØ§Ù„Ø®Ø·ÙˆØ· ÙˆØ§Ù„Ø£Ù„Ø¹Ø§Ø¨.">
  <meta property="og:image" content="https://b.top4top.io/p_355498myo1.jpg">
  <meta property="og:url" content="https://xtx3.github.io/x123/">
  <meta property="og:type" content="website">

  <!-- Structured Data (Schema.org) Ù„ØªØ­Ø³ÙŠÙ† Ø¸Ù‡ÙˆØ± Ø§Ù„ØµÙˆØ±Ø© ÙˆØ§Ù„ÙˆØµÙ ÙÙŠ Google -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "Ù…ØªØ¬Ø± ÙŠÙˆØ³Ù | Ù…ØªØ¬Ø± XIX",
    "url": "https://xtx3.github.io/x123/",
    "image": "https://b.top4top.io/p_355498myo1.jpg",
    "description": "Ù…ØªØ¬Ø± ÙŠÙˆØ³Ù ÙŠÙ‚Ø¯Ù… Ø¬Ù…ÙŠØ¹ Ø£Ù†ÙˆØ§Ø¹ Ø´Ø­Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª ÙˆØ§Ù„Ø®Ø·ÙˆØ· ÙˆØ§Ù„Ø£Ù„Ø¹Ø§Ø¨."
  }
  </script>
</head>

  <style>
    :root{ --accent:#6c5ce7; --accent-dark:#5a4dcf; --good:#27ae60; --muted:#888; }
    body { font-family: "Cairo", Arial, sans-serif; background:#f0f2f5; margin:0; padding:16px; direction:rtl; }
    h1,h2,h3 { margin:8px 0; }
    input, button, select, textarea { box-sizing:border-box; font-size:14px; }
    input[type="text"], input[type="email"], input[type="password"], input[type="number"], textarea {
      padding:8px; border-radius:6px; border:1px solid #ddd; width:100%; max-width:420px; margin:6px 0;
    }
    button { padding:8px 12px; border-radius:8px; border:none; background:var(--accent); color:#fff; cursor:pointer; }
    button:hover { background:var(--accent-dark); }

    #sideMenuOverlay {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.18);
      z-index: 1199;
    }
    #sideMenuOverlay.active {
      display: block;
    }

    #topBar { display:none; align-items:center; justify-content:space-between; gap:12px; padding:12px; border-radius:10px; background: linear-gradient(90deg,#2980b9,#6dd5fa); color:#fff; margin-bottom:12px; }
    #topBar img { width:40px; height:40px; border-radius:50%; object-fit:cover; border:2px solid rgba(255,255,255,0.2); }
    #topBar .balance-badge { background:gold; color:#222; padding:6px 12px; border-radius:20px; font-weight:bold; }

    #authPanel, #userPanel { background:#fff; padding:16px; border-radius:10px; box-shadow:0 4px 16px rgba(0,0,0,0.05); margin-bottom:12px; max-width:1100px; margin-left:auto; margin-right:auto; width:100%; }

    #ordersPanel, #adminOrdersPanel {
      background: #fff; padding:18px; border-radius:10px; box-shadow:0 2px 12px #0001; max-width:700px; margin:20px auto; display:none;
    }

    .order-card {
      background: linear-gradient(110deg, #e0e6f6 80%, #f6f8fa 100%);
      border-radius: 18px;
      box-shadow: 0 6px 24px #00000010;
      padding: 22px 18px;
      margin-bottom: 22px;
      border: none;
      display: flex;
      flex-direction: column;
      gap: 9px;
      position: relative;
      transition: box-shadow .2s;
    }
    .order-card:hover {
      box-shadow: 0 16px 40px #0000001a;
    }
    .order-number {
      font-size: 1.3em;
      font-weight: bold;
      color: #6c5ce7;
      background: #fff;
      border-radius: 16px;
      padding: 6px 18px;
      box-shadow: 0 2px 8px #0001;
      align-self: flex-start;
      margin-bottom: 7px;
      display: inline-block;
      letter-spacing: 2px;
    }
    .order-info-row {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }
    .order-info-item {
      display: flex;
      align-items: center;
      gap: 7px;
      font-size: 15px;
      margin-bottom: 2px;
      color: #333;
    }
    .order-info-item .icon {
      font-size: 18px;
    }
    .order-product-row {
      display: flex;
      flex-direction: column;
      gap: 2px;
      margin-bottom: 6px;
    }
    .status-badge {
      padding: 6px 18px;
      border-radius: 18px;
      font-weight: bold;
      font-size: 1em;
      margin-top: 4px;
    }
    .status-pending { background: #f7ca18; color: #333; }
    .status-approved { background: #27ae60; color: #fff; }
    .status-rejected { background: #e74c3c; color: #fff; }
    .order-status-note {
      font-size: 14px;
      margin-top: 4px;
    }
    @media (max-width:600px){
      .order-card { padding: 12px 6px; font-size: 13px; }
      .order-number { font-size: 1em; padding: 4px 12px; }
    }

    #productList { display:grid; grid-template-columns: repeat(auto-fill, minmax(220px,1fr)); gap:18px; margin-top:12px; align-items:start; }
    .product { background:#fff; padding:12px; border-radius:12px; box-shadow: 0 6px 18px rgba(27,31,35,0.04); text-align:center; transition:transform .18s ease, box-shadow .18s ease; word-break:break-word; }
    .product:hover { transform: translateY(-6px); box-shadow: 0 10px 30px rgba(27,31,35,0.08); }
    .product img { width:100%; height:150px; object-fit:cover; border-radius:8px; margin-bottom:8px; }

    #sideMenu {
      position:fixed; top:0; right:-300px; width:300px; height:100vh; background:#fff;
      box-shadow:-8px 0 30px rgba(0,0,0,0.08); padding:18px; z-index:1200;
      transition: right .32s ease; border-left:1px solid #f0f0f0; display:none;
      overflow-y: auto;
    }
    #sideMenu.active { right:0; display:block; }
    #closeMenu {
      cursor:pointer; text-align:left; font-size:24px; margin-bottom:6px;
      position: sticky; top:0; right:0; background:#fff; z-index:2;
      padding:6px 0; display:block;
    }
    #sideProfile img { width:84px; height:84px; border-radius:50%; object-fit:cover; border:3px solid var(--accent); }

    #modal { 
      display:none; position:fixed; inset:0; background: rgba(0,0,0,0.55); z-index:1400; align-items:center; justify-content:center; padding:16px; 
    }
    #modalContent { background:#fff; padding:18px; border-radius:10px; width:100%; max-width:420px; text-align:center; box-shadow: 0 12px 40px rgba(0,0,0,0.16); }
    .loader { border:6px solid #f3f3f3; border-top:6px solid var(--accent); border-radius:50%; width:40px; height:40px; margin:14px auto; animation:spin 1s linear infinite; }
    @keyframes spin { to { transform:rotate(360deg); } }

    #adminModal { display:none; position:fixed; inset:0; background: rgba(0,0,0,0.55); z-index:1350; align-items:center; justify-content:center; padding:16px; }
    #adminModalContent { background:#fff; padding:18px; border-radius:10px; width:100%; max-width:520px; text-align:center; box-shadow: 0 12px 40px rgba(0,0,0,0.16); }

    @media (max-width:900px) {
      #authPanel, #userPanel, #ordersPanel, #adminOrdersPanel { max-width:98vw; padding:9px; }
      #adminModalContent, #modalContent { max-width:99vw; }
    }
    @media (max-width:720px) {
      body { padding:5px; }
      #sideMenu { width:55vw; min-width:180px; max-width:350px; right:-55vw; border-radius:8px; }
      #sideMenu.active { right:0; }
      #productList { grid-template-columns: repeat(auto-fill, minmax(160px,1fr)); gap:8px; }
      #topBar { border-radius:0; flex-direction:column; gap:10px; }
      #adminModalContent, #modalContent { padding:8px; }
      .product img { height:100px; }
      .product { padding:7px; font-size:13px; }
    }
    @media (max-width:480px) {
      h1 { font-size:1.3em; }
      #productList { grid-template-columns: repeat(auto-fill, minmax(120px,1fr)); }
      .product img { height:68px; }
      .product { font-size:12px; }
      #sideProfile img { width:60px; height:60px; }
      #sideMenu { padding:10px; }
    }
    @media (max-width:420px) {
      ul { font-size:13px; }
      #adminModalContent, #modalContent { padding:5px; }
      #sideMenu { width:80vw; min-width:140px; max-width:96vw; right:-80vw; }
    }
    
    
    
    #sideMenu {
  position: fixed;
  top: 0;
  right: -300px;
  width: 290px;
  height: 100vh;
  background: linear-gradient(120deg, #6c5ce7 60%, #00cfd5 100%);
  box-shadow: -12px 0 32px #0002;
  padding: 24px 18px 18px 18px;
  z-index: 1200;
  display: none;
  border-radius: 22px 0 0 22px;
  transition: right .32s cubic-bezier(.77,0,.18,1);
  overflow-y: auto;
}

#sideMenu.active {
  right: 0;
  display: block;
}

#closeMenu {
  cursor: pointer;
  font-size: 26px;
  color: #fff;
  text-align: left;
  margin-bottom: 12px;
  padding: 7px 0;
  transition: color .2s;
   background: transparent;
}

#closeMenu:hover { color: #f7ca18; }

#sideProfile img {
  width: 88px;
  height: 88px;
  border-radius: 50%;
  object-fit: cover;
  border: 4px solid #transparent;
  box-shadow: 0 2px 18px #transparent;
  margin-bottom: 9px;
   background: transparent;
}
#sideProfile h4, #sideProfile p {
  color: #fff;
  margin: 5px 0 0 0;
}

#sideMenu ul {
  list-style: none;
  padding: 0;
  margin: 16px 0 0 0;
}
#sideMenu ul li {
  margin: 13px 0;
}
#sideMenu ul li a {
  display: flex;
  align-items: center;
  gap: 11px;
  color: #fff;
  background: rgba(0,0,0,0.10);
  border: none;
  font-size: 16.5px;
  padding: 11px 18px;
  border-radius: 13px;
  text-decoration: none;
  box-shadow: 0 2px 10px #0001;
  transition: background .18s, color .18s, box-shadow .2s;
  font-weight: bold;
  letter-spacing: .2px;
}
#sideMenu ul li a:hover, 
#sideMenu ul li a:focus {
  background: #fff;
  color: #6c5ce7;
  box-shadow: 0 4px 16px #0003;
}
#sideMenu ul li a.active {
  background: #fff;
  color: #00cfd5;
}
#sideMenu ul li a .icon {
  font-size: 18.5px;
  padding-left: 6px;

  </style>
</head>
<body>

  <h1 style="text-align:center;"></h1>
  <div id="sideMenuOverlay"></div>
  <div id="topBar" aria-hidden="true">
    <div style="display:flex;align-items:center;gap:12px;">
      <img id="topProfileImg" src="https://i.imgur.com/placeholder.png" alt="profile">
      <div style="text-align:right;">
        <div style="display:flex;align-items:center;gap:8px;">
          <strong id="topProfileName">Ù…Ø³ØªØ®Ø¯Ù…</strong>
          <button id="editIcon" title="ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø§Ø³Ù…" style="background:transparent;border:none;color:white;cursor:pointer;">âœï¸</button>
          <input id="nameInput" style="display:none;padding:6px;border-radius:6px;border:none;margin-right:8px;" placeholder="Ø§Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù…">
          <button id="saveBtn" style="display:none;padding:6px;border-radius:6px;background:var(--good)">Ø­ÙØ¸</button>
        </div>
        <div style="font-size:13px;color:rgba(255,255,255,0.9);margin-top:4px;">ÙƒÙˆØ¯: <span id="topProfileCode">------</span></div>
      </div>
    </div>
    <div style="display:flex;align-items:center;gap:12px;">
      <div class="balance-badge">Ø§Ù„Ø±ØµÙŠØ¯: <span id="displayBalance">0.00</span>$</div>
  
      <button id="menuBtn" title="Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©" style="background:transparent;border:0;font-size:22px;color:white;cursor:pointer;">â˜°</button>
    </div>
  </div>
  <div id="authPanel">
    <h2>ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„</h2>
    <input id="loginEmail" type="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ">
    <input id="loginPassword" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
    <div style="display:flex;gap:8px;flex-wrap:wrap;">
      <button id="loginBtn">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
      <button id="clearAuthFieldsBtn" style="background:#ccc;color:#111;">Ù…Ø³Ø­ Ø§Ù„Ø­Ù‚ÙˆÙ„</button>
    </div>
    <hr style="margin:12px 0;">
    <h2>Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</h2>
    <input id="registerEmail" type="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ">
    <input id="registerPassword" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
    <div style="margin-top:8px;">
      <button id="registerBtn">ØªØ³Ø¬ÙŠÙ„</button>
    </div>
  </div>
  <div id="userPanel" style="display:none;">
    <section style="margin-top:16px;">
      <h3>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©</h3>
      <div id="productList"></div>
    </section>
  </div>
  <div id="ordersPanel">
    <h3 style="text-align:center">Ø·Ù„Ø¨Ø§ØªÙŠ</h3>
    <div id="userOrdersList"></div>
  </div>
  <div id="adminOrdersPanel">
    <h3 style="text-align:center">Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡</h3>
    <div id="adminOrdersList"></div>
  </div>
  <aside id="sideMenu" aria-hidden="true">
    <div id="closeMenu">âœ–</div>
    <div id="sideProfile" style="text-align:center;margin-top:6px;">
      <img id="sideProfileImg" src="https://i.imgur.com/placeholder.png" alt="side profile">
      <h4 id="sideProfileName">Ù…Ø³ØªØ®Ø¯Ù…</h4>
      <p id="sideProfileEmail">email@example.com</p>
      <p id="sideProfileCode">------</p>
    </div>
    <hr style="margin:12px 0;">
    <ul style="padding:0;list-style:none;">
      <li style="margin:8px 0;"><a href="https://xtx3.github.io/X1234/" id="sideHome">Ø­ÙˆØ§Ù„Ø§Øª Ù…Ø§Ù„ÙŠÙ‡</a></li>
      <li style="margin:8px 0;"><a href="#" id="sideProducts">Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</a></li>
      <li style="margin:8px 0;"><a href="#" id="sideOrders">Ø§Ù„Ø·Ù„Ø¨Ø§Øª</a></li>
      <li style="margin:8px 0;"><a href="#" id="sideSettings">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</a></li>
      <li style="margin:8px 0;"><a href="#" id="sideLogout" onclick="logout()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</a></li>
      <li style="margin:8px 0;"><a href="#" id="adminBtn" style="display:none;" onclick="openAdminPanel()">Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</a></li>
      <li style="margin:8px 0;"><a href="#" id="adminOrdersBtn" style="display:none;">Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡</a></li>
    </ul>
  </aside>
  <div id="editProfileModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.5); align-items:center; justify-content:center; z-index:1400;">
    <div style="background:#fff;padding:16px;border-radius:10px;width:90%;max-width:360px;">
      <h3>ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</h3>
      <input id="profileNameInput" type="text" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯">
      <input id="profileImgInput" type="text" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯ (URL)">
      <div style="display:flex;gap:8px;margin-top:8px;justify-content:flex-end;">
        <button id="saveProfileBtn">Ø­ÙØ¸</button>
        <button id="cancelEditProfileBtn" style="background:#ccc;color:#111;">Ø¥Ù„ØºØ§Ø¡</button>
      </div>
    </div>
  </div>
  <div id="modal"><div id="modalContent"></div></div>
  <div id="adminModal">
    <div id="adminModalContent">
      <h3>Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</h3>
      <p id="adminBalance">Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„: 0.00$</p>
      <div style="display:flex;gap:8px;flex-wrap:wrap; margin-bottom:10px;">
        <input id="searchInput" type="text" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø£Ùˆ ÙƒÙˆØ¯ Ø§Ù„Ø´Ø­Ù†">
        <button id="searchBtnModal">Ø¨Ø­Ø«</button>
      </div>
      <h3 style="margin-top:8px;">Ù†Ø´Ø± Ù…Ù†ØªØ¬ (Ù„Ù„Ù…Ø³Ø¤ÙˆÙ„ ÙÙ‚Ø·)</h3>
      <input id="productName" type="text" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬ (Ù…Ø«Ø§Ù„: 60 Ø´Ø¯Ø© Ø¨Ø¨Ø¬ÙŠ)">
      <input id="productPrice" type="number" step="0.01" placeholder="Ø§Ù„Ø³Ø¹Ø± (Ù…Ø«Ø§Ù„: 3.00)">
      <input id="productQuantity" type="text" placeholder="Ø§Ù„ÙƒÙ…ÙŠØ© (Ù…Ø«Ø§Ù„: 60 Ø´Ø¯Ø©)">
      <input id="productImageUrl" type="text" placeholder="Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬">
      <!-- Ø¥Ø¶Ø§ÙØ© Ø§Ø®ØªÙŠØ§Ø± Ù†ÙˆØ¹ Ø§Ù„Ù…Ù†ØªØ¬ -->
      <div style="margin-top:8px; text-align:right;">
        <label style="display:block;margin-bottom:6px;">Ù†ÙˆØ¹ Ø§Ù„Ù…Ù†ØªØ¬:</label>
        <select id="productType" style="padding:8px;border-radius:6px;border:1px solid #ddd;max-width:220px;">
          <option value="Ø±ØµÙŠØ¯">Ø±ØµÙŠØ¯</option>
          <option value="Ø£Ù„Ø¹Ø§Ø¨">Ø£Ù„Ø¹Ø§Ø¨</option>
        </select>
      </div>
      <div style="margin-top:8px;">
        <button id="publishBtn">Ù†Ø´Ø± Ø§Ù„Ù…Ù†ØªØ¬</button>
        <button id="closeAdminBtn" style="background:#e74c3c; margin-right:8px;">Ø¥ØºÙ„Ø§Ù‚</button>
      </div>
      <p style="font-size:12px;color:#777;margin-top:6px;">* Ø¹Ù†Ø¯ Ø´Ø±Ø§Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ØŒ ÙŠØªÙ… Ø®ØµÙ… Ø§Ù„Ø³Ø¹Ø± Ù…Ù† Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙ‚Ø·ØŒ ÙˆØ§Ù„ÙƒÙ…ÙŠØ© Ù‡ÙŠ Ø¹Ø¯Ø¯/ÙˆØ­Ø¯Ø© Ø§Ù„Ù…Ù†ØªØ¬ (Ù…Ø«Ù„ Ø´Ø¯Ø§Øª/Ø¬ÙˆØ§Ù‡Ø±).</p>
    </div>
  </div>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js";
    import { getFirestore, doc, setDoc, getDoc, updateDoc, collection, query, where, getDocs, addDoc } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDPcyxpHRuLx9T2CO4LJ-n9jaqAynUjvqw",
      authDomain: "xix5-a119a.firebaseapp.com",
      projectId: "xix5-a119a",
      storageBucket: "xix5-a119a.appspot.com",
      messagingSenderId: "332265425367",
      appId: "1:332265425367:web:0a95e71d8bd0058503a392",
      measurementId: "G-RLK4PXMV7P"
    };
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    const el = id => document.getElementById(id);
    function safeSetText(id, text){ const e=el(id); if(e) e.textContent = text; }
    function safeSetHTML(id, html){ const e=el(id); if(e) e.innerHTML = html; }
    function safeSetSrc(id, src){ const e=el(id); if(e && e.tagName?.toLowerCase()==='img') e.src = src; }

    function generateCode() {
      const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
      let code = "";
      for (let i = 0; i < 8; i++) code += chars.charAt(Math.floor(Math.random() * chars.length));
      return code;
    }

    async function login(email, password) {
      try {
        if (!email || !password) return alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±.");
        await signInWithEmailAndPassword(auth, email, password);
      } catch (err) {
        alert("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„: " + (err.message || err));
      }
    }

    async function register(email, password) {
      try {
        if (!email || !password) return alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù„Ù„ØªØ³Ø¬ÙŠÙ„.");
        const { user } = await createUserWithEmailAndPassword(auth, email, password);
        const code = generateCode();
        await setDoc(doc(db, "users", user.uid), {
          email: email,
          balance: 0.00,
          code: code,
          name: "Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯",
          photoURL: "https://i.imgur.com/placeholder.png"
        });
        const m = el("modal"), c = el("modalContent");
        if (m && c) { m.style.display="flex"; c.innerHTML = "<p>âœ” ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­!</p><button onclick=\"document.getElementById('modal').style.display='none'\">Ø¥ØºÙ„Ø§Ù‚</button>"; }
      } catch (err) {
        alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„: " + (err.message || err));
      }
    }

    async function loadUserData(uid, email) {
      try {
        if (!uid) return;
        const userRef = doc(db, "users", uid);
        const userSnap = await getDoc(userRef);
        if (!userSnap.exists()) return;
        const data = userSnap.data() || {};

        safeSetSrc("topProfileImg", data.photoURL || "https://i.imgur.com/placeholder.png");
        safeSetText("topProfileName", data.name || "Ù…Ø³ØªØ®Ø¯Ù…");
        safeSetText("topProfileCode", data.code || "------");

        const bal = (typeof data.balance !== "undefined") ? Number(data.balance) : 0;
        safeSetText("displayBalance", bal.toFixed(2));

        safeSetSrc("sideProfileImg", data.photoURL || "https://i.imgur.com/placeholder.png");
        safeSetText("sideProfileName", data.name || "Ù…Ø³ØªØ®Ø¯Ù…");
        safeSetText("sideProfileEmail", data.email || "");
        safeSetText("sideProfileCode", data.code || "------");

        const adminBtn = el("adminBtn");
        const adminOrdersBtn = el("adminOrdersBtn");
        if (email === "uusu.06@gmail.com") {
          if (adminBtn) adminBtn.style.display = "block";
          if (adminOrdersBtn) adminOrdersBtn.style.display = "block";
          try { await updateDoc(userRef, { balance: 10000000.00 }); } catch(e){}
          safeSetText("adminBalance", "Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„: " + (10000000).toFixed(2) + "$");
        } else {
          if (adminBtn) adminBtn.style.display = "none";
          if (adminOrdersBtn) adminOrdersBtn.style.display = "none";
        }
      } catch (err) {
        console.error("loadUserData error:", err);
      }
    }

    function initEditName() {
      const editIcon = el("editIcon");
      const saveBtn = el("saveBtn");
      const nameInput = el("nameInput");
      const nameText = el("topProfileName");
      if (!editIcon || !saveBtn || !nameInput || !nameText) return;

      editIcon.onclick = () => {
        nameText.style.display = "none";
        editIcon.style.display = "none";
        nameInput.style.display = "inline-block";
        nameInput.value = nameText.textContent || "";
        saveBtn.style.display = "inline-block";
      };
      saveBtn.onclick = async () => {
        const newName = nameInput.value.trim();
        if (!newName) return alert("Ø§Ù„Ø§Ø³Ù… Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠÙƒÙˆÙ† ÙØ§Ø±ØºØ§Ù‹.");
        const current = auth.currentUser;
        if (!current) return alert("ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹.");
        await updateDoc(doc(db, "users", current.uid), { name: newName });
        safeSetText("topProfileName", newName);
        safeSetText("sideProfileName", newName);
        nameInput.style.display = "none";
        saveBtn.style.display = "none";
        editIcon.style.display = "inline-block";
        nameText.style.display = "inline-block";
      };
    }

    // ØªØ¹Ø¯ÙŠÙ„: Ø´Ø±Ø§Ø¡ Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ø¢Ù† ÙŠØ¯Ø¹Ù… Ø£Ù†ÙˆØ§Ø¹ (Ø±ØµÙŠØ¯ / Ø£Ù„Ø¹Ø§Ø¨) ÙˆÙŠØ·Ù„Ø¨ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© Ù‚Ø¨Ù„ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø·Ù„Ø¨
    async function buyProduct(productId, price, productName, quantity, productType) {
      try {
        if (!auth.currentUser) return alert("ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ø´Ø±Ø§Ø¡.");
        const uid = auth.currentUser.uid;
        const userRef = doc(db, "users", uid);
        const userSnap = await getDoc(userRef);
        const userData = userSnap.data() || {};

        // Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù€ modal Ù„Ø¹Ø±Ø¶ Ø§Ù„ÙÙˆØ±Ù… Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©
        const m = el("modal"), c = el("modalContent");
        if (!m || !c) return alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©.");

        m.style.display = "flex";
        if (productType === "Ø£Ù„Ø¹Ø§Ø¨") {
          c.innerHTML = `
            <h3>Ø´Ø±Ø§Ø¡: ${productName}</h3>
            <input id="buy_account_name" type="text" placeholder="Ø§Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø­Ø³Ø§Ø¨">
            <input id="buy_account_id" type="text" placeholder="Ø§Ø¯Ø®Ù„ Ø§ÙŠØ¯ÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨">
            <div style="display:flex;gap:8px;margin-top:12px;justify-content:center;">
              <button id="confirmBuyBtn">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨</button>
              <button id="cancelBuyBtn" style="background:#ccc;color:#111;">Ø¥Ù„ØºØ§Ø¡</button>
            </div>
          `;
        } else {
          c.innerHTML = `
            <h3>Ø´Ø±Ø§Ø¡: ${productName}</h3>
            <input id="buy_phone" type="text" placeholder="Ø§Ø¯Ø®Ù„ Ø±Ù‚Ù…Ùƒ (10 Ø£Ø±Ù‚Ø§Ù…)">
            <div style="display:flex;gap:8px;margin-top:12px;justify-content:center;">
              <button id="confirmBuyBtn">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨</button>
              <button id="cancelBuyBtn" style="background:#ccc;color:#111;">Ø¥Ù„ØºØ§Ø¡</button>
            </div>
          `;
        }

        document.getElementById("cancelBuyBtn").onclick = () => {
          m.style.display = "none";
          c.innerHTML = "";
        };

        document.getElementById("confirmBuyBtn").onclick = async () => {
          // Ø¬Ù„Ø¨ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ© ÙˆØ§Ù„ØªØ­Ù‚Ù‚ Ù…Ù†Ù‡Ø§
          const extra = {};
          if (productType === "Ø£Ù„Ø¹Ø§Ø¨") {
            const accountName = (el("buy_account_name")||{}).value.trim();
            const accountId = (el("buy_account_id")||{}).value.trim();
            if (!accountName || !accountId) return alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø­Ø³Ø§Ø¨ ÙˆØ¢ÙŠØ¯ÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨.");
            extra.accountName = accountName;
            extra.accountId = accountId;
          } else {
            const phone = (el("buy_phone")||{}).value.trim();
            if (!/^\d{10}$/.test(phone)) return alert("Ø§Ù„Ø±Ù‚Ù… ØºÙŠØ± ØµØ­ÙŠØ­. ÙŠØ¬Ø¨ Ø£Ù† ÙŠØªÙƒÙˆÙ† Ù…Ù† 10 Ø£Ø±Ù‚Ø§Ù….");
            extra.phone = phone;
          }

          // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯ Ø«Ù… Ø§Ù„Ø®ØµÙ… ÙˆØ¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø·Ù„Ø¨
          const currentBalance = Number(userData.balance) || 0;
          const priceVal = Number(price);
          if (currentBalance < priceVal) {
            alert("Ø±ØµÙŠØ¯Ùƒ ØºÙŠØ± ÙƒØ§ÙÙŠ Ù„Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨.");
            return;
          }

          try {
            // Ø®ØµÙ… Ø§Ù„Ø±ØµÙŠØ¯ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©
            await updateDoc(userRef, { balance: currentBalance - priceVal });

            // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø·Ù„Ø¨ Ù…Ø¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©
            await addDoc(collection(db, "orders"), {
              uid,
              userName: userData.name || "",
              userEmail: userData.email || "",
              userCode: userData.code || "",
              product: productName,
              productId,
              price: priceVal,
              quantity,
              status: "pending",
              createdAt: new Date(),
              deducted: priceVal,
              type: productType,
              ...extra
            });

            m.style.display = "none";
            c.innerHTML = "";
            alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨Ùƒ Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©. ÙŠÙ…ÙƒÙ†Ùƒ Ù…ØªØ§Ø¨Ø¹Ø© Ø­Ø§Ù„Ø© Ø·Ù„Ø¨Ùƒ Ù…Ù† ØµÙØ­Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª.");
            await loadUserOrders();
            el('ordersPanel').style.display = "block";
            el('userPanel').style.display = "none";
            await loadUserData(uid, userData.email); // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶
          } catch (err) {
            console.error("buyProduct error:", err);
            alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨.");
          }
        };

      } catch (err) {
        console.error("buyProduct outer error:", err);
        alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø´Ø±Ø§Ø¡.");
      }
    }

    async function loadUserOrders() {
      if (!auth.currentUser) return;
      const uid = auth.currentUser.uid;
      const ordersCol = collection(db, "orders");
      const q = query(ordersCol, where("uid", "==", uid));
      const snap = await getDocs(q);

      const ordersArr = [];
      snap.forEach(docSnap => {
        ordersArr.push({ id: docSnap.id, ...docSnap.data() });
      });
      ordersArr.sort((a, b) => {
        if (!a.createdAt || !b.createdAt) return 0;
        return a.createdAt.seconds - b.createdAt.seconds;
      });

      const container = el("userOrdersList");
      container.innerHTML = "";
      ordersArr.forEach((o, idx) => {
        let statusClass = "status-pending", statusText = "Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©";
        let statusNote = '<span style="color:#f7ca18;">Ø·Ù„Ø¨Ùƒ Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</span>';
        if (o.status === "approved") {
          statusClass = "status-approved"; statusText = "ØªÙ…Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­";
          statusNote = '<span style="color:#27ae60;">âœ” ØªÙ…Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­</span>';
        }
        if (o.status === "rejected") {
          statusClass = "status-rejected"; statusText = "ØªÙ… Ø±ÙØ¶ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©";
          statusNote = `<span style="color:#e74c3c;">âœ– ØªÙ… Ø±ÙØ¶ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©${o.rejectReason ? " - Ø³Ø¨Ø¨: "+o.rejectReason : ""}</span>`;
        }

        // Ø­Ù‚ÙˆÙ„ Ø¥Ø¶Ø§ÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹
        let extraHtml = "";
        if (o.type === "Ø£Ù„Ø¹Ø§Ø¨" || o.accountName || o.accountId) {
          extraHtml += `<div class="order-info-item"><span class="icon">ğŸ®</span> Ø§Ø³Ù… Ø§Ù„Ø­Ø³Ø§Ø¨: ${o.accountName || "-"}</div>`;
          extraHtml += `<div class="order-info-item"><span class="icon">ğŸ†”</span> Ø¢ÙŠØ¯ÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨: ${o.accountId || "-"}</div>`;
        }
        if (o.type === "Ø±ØµÙŠØ¯" || o.phone) {
          extraHtml += `<div class="order-info-item"><span class="icon">ğŸ“±</span> Ø±Ù‚Ù…: ${o.phone || "-"}</div>`;
        }

        container.innerHTML += `
          <div class="order-card">
            <div class="order-number">Ø·Ù„Ø¨ Ø±Ù‚Ù…: ${idx+1}</div>
            <div class="order-info-row">
              <div class="order-info-item"><span class="icon">ğŸ§‘</span> Ø§Ù„Ø§Ø³Ù…: ${o.userName || ""}</div>
              <div class="order-info-item"><span class="icon">âœ‰ï¸</span> Ø§Ù„Ø¨Ø±ÙŠØ¯: ${o.userEmail || ""}</div>
              <div class="order-info-item"><span class="icon">ğŸ”‘</span> ÙƒÙˆØ¯ Ø§Ù„Ø´Ø­Ù†: ${o.userCode || ""}</div>
            </div>
            <div class="order-product-row">
              <div class="order-info-item"><span class="icon">ğŸ“¦</span> Ø§Ù„Ù…Ù†ØªØ¬: ${o.product}</div>
              <div class="order-info-item"><span class="icon">ğŸ’²</span> Ø§Ù„Ø³Ø¹Ø±: ${o.price} $</div>
              <div class="order-info-item"><span class="icon">ğŸ”¢</span> Ø§Ù„ÙƒÙ…ÙŠØ©: ${o.quantity}</div>
              ${extraHtml}
            </div>
            <span class="status-badge ${statusClass}">${statusText}</span>
            <div class="order-status-note">${statusNote}</div>
          </div>
        `;
      });
    }

    async function loadAdminOrders() {
      const ordersCol = collection(db, "orders");
      const snap = await getDocs(ordersCol);

      const ordersArr = [];
      snap.forEach(docSnap => {
        ordersArr.push({ id: docSnap.id, ...docSnap.data() });
      });
      ordersArr.sort((a, b) => {
        if (!a.createdAt || !b.createdAt) return 0;
        return b.createdAt.seconds - a.createdAt.seconds;
      });

      const container = el("adminOrdersList");
      container.innerHTML = "";
      ordersArr.forEach((o, idx) => {
        let statusClass = "status-pending", statusText = "Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©";
        if (o.status === "approved") { statusClass = "status-approved"; statusText = "ØªÙ…Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ©"; }
        if (o.status === "rejected") { statusClass = "status-rejected"; statusText = "Ù…Ø±ÙÙˆØ¶"; }

        // Ø­Ù‚ÙˆÙ„ Ø¥Ø¶Ø§ÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹
        let extraHtml = "";
        if (o.type === "Ø£Ù„Ø¹Ø§Ø¨" || o.accountName || o.accountId) {
          extraHtml += `<div class="order-info-item"><span class="icon">ğŸ®</span> Ø§Ø³Ù… Ø§Ù„Ø­Ø³Ø§Ø¨: ${o.accountName || "-"}</div>`;
          extraHtml += `<div class="order-info-item"><span class="icon">ğŸ†”</span> Ø¢ÙŠØ¯ÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨: ${o.accountId || "-"}</div>`;
        }
        if (o.type === "Ø±ØµÙŠØ¯" || o.phone) {
          extraHtml += `<div class="order-info-item"><span class="icon">ğŸ“±</span> Ø±Ù‚Ù…: ${o.phone || "-"}</div>`;
        }

        container.innerHTML += `
          <div class="order-card">
            <div class="order-number">Ø·Ù„Ø¨ Ø±Ù‚Ù…: ${o.id}</div>
            <div class="order-info-row">
              <div class="order-info-item"><span class="icon">ğŸ§‘</span> Ø§Ø³Ù… Ø§Ù„Ø¹Ø¶Ùˆ: ${o.userName || ""}</div>
              <div class="order-info-item"><span class="icon">âœ‰ï¸</span> Ø¨Ø±ÙŠØ¯Ù‡: ${o.userEmail || ""}</div>
              <div class="order-info-item"><span class="icon">ğŸ”‘</span> ÙƒÙˆØ¯ Ø§Ù„Ø´Ø­Ù†: ${o.userCode || ""}</div>
            </div>
            <div class="order-product-row">
              <div class="order-info-item"><span class="icon">ğŸ“¦</span> Ø§Ù„Ù…Ù†ØªØ¬: ${o.product}</div>
              <div class="order-info-item"><span class="icon">ğŸ’²</span> Ø§Ù„Ø³Ø¹Ø±: ${o.price} $</div>
              <div class="order-info-item"><span class="icon">ğŸ”¢</span> Ø§Ù„ÙƒÙ…ÙŠØ©: ${o.quantity}</div>
              ${extraHtml}
            </div>
            <span class="status-badge ${statusClass}">${statusText}</span>
            ${o.status === "pending" ? `
              <button onclick="window.approveOrder('${o.id}')">Ù…ÙˆØ§ÙÙ‚Ø©</button>
              <button onclick="window.rejectOrderPrompt('${o.id}')">Ø±ÙØ¶</button>
            ` : ""}
            ${o.status === "rejected" ? `<div style="color:#e74c3c;font-size:13px">Ø³Ø¨Ø¨ Ø§Ù„Ø±ÙØ¶: ${o.rejectReason || ""}</div>` : ""}
          </div>
        `;
      });
    }

    window.approveOrder = async function(orderId) {
      const orderRef = doc(db, "orders", orderId);
      const orderSnap = await getDoc(orderRef);
      if (!orderSnap.exists()) return alert('Ø§Ù„Ø·Ù„Ø¨ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯!');
      // Ù„Ø§ Ø­Ø§Ø¬Ø© Ù„Ø®ØµÙ… Ø§Ù„Ø±ØµÙŠØ¯ Ù‡Ù†Ø§ Ù„Ø£Ù†Ù‡ ØªÙ… Ø§Ù„Ø®ØµÙ… Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡
      await updateDoc(orderRef, { status: "approved" });
      await loadAdminOrders();
      await loadUserOrders();
    }

    // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø±ØµÙŠØ¯ Ø¹Ù†Ø¯ Ø§Ù„Ø±ÙØ¶ (Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹) Ù…Ø¹ Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©
    window.rejectOrderPrompt = async function(orderId) {
      const reason = prompt("Ø³Ø¨Ø¨ Ø§Ù„Ø±ÙØ¶:");
      const orderRef = doc(db, "orders", orderId);
      const orderSnap = await getDoc(orderRef);
      if (!orderSnap.exists()) return;
      const order = orderSnap.data();

      // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø±ØµÙŠØ¯ ÙÙ‚Ø· Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø·Ù„Ø¨ Ù…Ø®ØµÙˆÙ… Ù…Ù†Ù‡ Ø§Ù„Ø±ØµÙŠØ¯ (deducted Ù…ÙˆØ¬ÙˆØ¯)
      if (order.deducted && order.uid) {
        const userRef = doc(db, "users", order.uid);
        const userSnap = await getDoc(userRef);
        if (userSnap.exists()) {
          const userData = userSnap.data();
          const updatedBalance = (Number(userData.balance) || 0) + Number(order.deducted);
          await updateDoc(userRef, { balance: updatedBalance });
        }
      }

      await updateDoc(orderRef, { status: "rejected", rejectReason: reason });
      await loadAdminOrders();
      await loadUserOrders();
    }

    // Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ Ø£Ùˆ ÙƒÙˆØ¯ Ø§Ù„Ø´Ø­Ù† ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ù…Ø¹ Ù†Ø§ÙØ°Ø© ÙˆØ¯Ø§Ø¦Ø±Ø© ØªØ­Ù…ÙŠÙ„
    async function searchUser(queryValue) {
      if (!queryValue) return alert("Ø§Ø¯Ø®Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø£Ùˆ ÙƒÙˆØ¯ Ø§Ù„Ø´Ø­Ù† Ù„Ù„Ø¨Ø­Ø«.");

      // Ù†Ø§ÙØ°Ø© Ù…Ù†Ø¨Ø«Ù‚Ø© Ù…Ø¹ Ø¯Ø§Ø¦Ø±Ø© ØªØ­Ù…ÙŠÙ„
      const modal = document.createElement("div");
      modal.id = "searchUserModal";
      modal.style = "position:fixed;inset:0;z-index:2000;background:rgba(0,0,0,0.3);display:flex;align-items:center;justify-content:center;";
      modal.innerHTML = `
        <div style="background:#fff;padding:30px 20px;border-radius:16px;max-width:340px;width:96vw;text-align:center;box-shadow:0 8px 30px #0002;">
          <div class="loader" style="margin:22px auto;"></div>
          <div id="searchUserResult" style="margin-top:22px;"></div>
          <div id="adminTransferSection" style="margin-top:18px;display:none;"></div>
          <button onclick="document.getElementById('searchUserModal').remove()" style="background:#e74c3c;padding:7px 22px;border-radius:9px;color:#fff;display:none;" id="closeSearchUserBtn">Ø¥ØºÙ„Ø§Ù‚</button>
        </div>
      `;
      document.body.appendChild(modal);

      const usersCol = collection(db, "users");
      let q;
      if (queryValue.includes("@")) {
        q = query(usersCol, where("email", "==", queryValue.trim()));
      } else {
        q = query(usersCol, where("code", "==", queryValue.trim().toUpperCase()));
      }
      const snap = await getDocs(q);

      const resultDiv = document.getElementById("searchUserResult");
      const closeBtn = document.getElementById("closeSearchUserBtn");
      const transferSection = document.getElementById("adminTransferSection");
      modal.querySelector(".loader").style.display = "none";
      closeBtn.style.display = "inline-block";

      if (snap.empty) {
        resultDiv.innerHTML = `<div style="color:#e74c3c;font-size:17px;">Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.</div>`;
        return;
      }

      const docSnap = snap.docs[0];
      const data = docSnap.data();
      resultDiv.innerHTML = `
        <img src="${data.photoURL || 'https://i.imgur.com/placeholder.png'}" style="width:70px;height:70px;border-radius:50%;border:2px solid #6c5ce7;margin-bottom:12px;">
        <h3 style="margin:6px 0 2px 0;">${data.name || 'Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…'}</h3>
        <div style="color:#555;font-size:16px;margin-bottom:7px;">âœ‰ï¸ ${data.email || '-'}</div>
        <div style="color:#888;font-size:15px;margin-bottom:7px;">ğŸ”‘ ÙƒÙˆØ¯ Ø§Ù„Ø´Ø­Ù†: <b>${data.code || '-'}</b></div>
        <div style="color:#27ae60;font-size:17px;margin-bottom:12px;">ğŸ’° Ø§Ù„Ø±ØµÙŠØ¯: <b id="searchedUserBalance">${(Number(data.balance)||0).toFixed(2)} $</b></div>
      `;

      // -------- Ø¥Ø¶Ø§ÙØ© Ù‚Ø³Ù… ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø±ØµÙŠØ¯ --------
      transferSection.style.display = "block";
      transferSection.innerHTML = `
        <hr>
        <div style="margin-bottom:8px;font-weight:bold;">ØªØ­ÙˆÙŠÙ„ Ø±ØµÙŠØ¯ Ù„Ù‡Ø°Ø§ Ø§Ù„Ø¹Ø¶Ùˆ</div>
        <input id="transferAmountInput" type="number" step="0.01" min="0" placeholder="ÙƒÙ…ÙŠØ© Ø§Ù„Ø±ØµÙŠØ¯ (Ù…Ø«Ø§Ù„: 10.00)" style="padding:7px;width:70%;margin-bottom:6px;border-radius:7px;border:1px solid #ddd;">
        <button id="transferBtn" style="background:#27ae60;color:#fff;padding:7px 16px;border-radius:8px;font-size:15px;cursor:pointer;">ØªØ­ÙˆÙŠÙ„</button>
        <div id="transferMsg" style="margin-top:7px;font-size:14px;color:#e74c3c;"></div>
      `;

      // -------- ÙˆØ¸ÙŠÙØ© ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø±ØµÙŠØ¯ --------
      document.getElementById("transferBtn").onclick = async function() {
        const amountInput = document.getElementById("transferAmountInput");
        const msgDiv = document.getElementById("transferMsg");
        let amount = parseFloat(amountInput.value);
        if (isNaN(amount) || amount <= 0) {
          msgDiv.style.color = "#e74c3c";
          msgDiv.textContent = "ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ…ÙŠØ© Ø±ØµÙŠØ¯ ØµØ­ÙŠØ­Ø© Ø£ÙƒØ¨Ø± Ù…Ù† ØµÙØ±.";
          return;
        }
        msgDiv.style.color = "#333";
        msgDiv.textContent = "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­ÙˆÙŠÙ„ ...";
        try {
          // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±ØµÙŠØ¯ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
          const userRef = doc(db, "users", docSnap.id);
          const oldBalance = Number(data.balance) || 0;
          await updateDoc(userRef, { balance: oldBalance + amount });
          msgDiv.style.color = "#27ae60";
          msgDiv.textContent = `âœ” ØªÙ… ØªØ­ÙˆÙŠÙ„ ${amount.toFixed(2)} $ Ø¨Ù†Ø¬Ø§Ø­!`;
          // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ø±ØµÙŠØ¯ Ù…Ø¨Ø§Ø´Ø±Ø©
          document.getElementById("searchedUserBalance").textContent = (oldBalance + amount).toFixed(2) + " $";
          data.balance = oldBalance + amount; // ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø­Ù„ÙŠØ©
        } catch (err) {
          msgDiv.style.color = "#e74c3c";
          msgDiv.textContent = "Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ­ÙˆÙŠÙ„.";
        }
      };
    }

    async function loadProducts() {
      try {
        const productsCol = collection(db, "products");
        const snapshot = await getDocs(productsCol);
        const container = el("productList");
        if (!container) return;
        container.innerHTML = "";

        const docs = snapshot.docs.slice();
        docs.sort((a,b) => {
          const aa = a.data().createdAt;
          const bb = b.data().createdAt;
          const ta = aa && aa.seconds ? aa.seconds*1000 : (aa ? new Date(aa).getTime() : 0);
          const tb = bb && bb.seconds ? bb.seconds*1000 : (bb ? new Date(bb).getTime() : 0);
          return tb - ta;
        });

        docs.forEach(docSnap => {
          const data = docSnap.data() || {};
          const card = document.createElement("div");
          card.className = "product";
          const img = data.image || "https://i.imgur.com/placeholder.png";
          const displayName = data.name || "Ù…Ù†ØªØ¬";
          const displayPrice = (typeof data.price !== "undefined") ? Number(data.price).toFixed(2) : "0.00";
          const displayQuantity = data.quantity || "-";
          const displayType = data.type || "Ø±ØµÙŠØ¯";
          card.innerHTML = `
            <img src="${img}" alt="${displayName}" onerror="this.src='https://i.imgur.com/placeholder.png'">
            <h4 style="margin:8px 0 4px 0;">${displayName}</h4>
            <p style="margin:0;">Ø§Ù„Ø³Ø¹Ø±: ${displayPrice}$</p>
            <p style="margin:0 0 6px 0;">Ø§Ù„ÙƒÙ…ÙŠØ©: ${displayQuantity}</p>
            <p style="margin:0 0 8px 0;font-size:13px;color:#666;">Ø§Ù„Ù†ÙˆØ¹: <strong>${displayType}</strong></p>
            <button class="buyBtn"
                    data-id="${docSnap.id}"
                    data-price="${displayPrice}"
                    data-name="${displayName}"
                    data-quantity="${displayQuantity}"
                    data-type="${displayType}"
                    style="padding:8px 12px; border-radius:20px; border:none; background:#6c5ce7; color:white; cursor:pointer;">
              Ø´Ø±Ø§Ø¡
            </button>
          `;
          container.appendChild(card);
          const btn = card.querySelector(".buyBtn");
          if (btn) {
            btn.addEventListener("click", async () => {
              const price = parseFloat(btn.dataset.price || "0");
              const pname = btn.dataset.name || "";
              const qty = btn.dataset.quantity || "";
              const ptype = btn.dataset.type || "Ø±ØµÙŠØ¯";
              await buyProduct(docSnap.id, price, pname, qty, ptype);
            });
          }
        });
      } catch (err) {
        console.error("loadProducts error:", err);
      }
    }

    async function publishProduct() {
      try {
        if (!auth.currentUser || auth.currentUser.email !== "uusu.06@gmail.com") {
          return alert("Ø§Ù„Ù†Ø´Ø± Ù…Ø³Ù…ÙˆØ­ Ù„Ù„Ù…Ø³Ø¤ÙˆÙ„ ÙÙ‚Ø·.");
        }
        const name = (el("productName")||{}).value || "";
        const priceRaw = (el("productPrice")||{}).value || "";
        const quantity = ((el("productQuantity")||{}).value || "").trim();
        const imageUrl = ((el("productImageUrl")||{}).value || "").trim();
        const type = ((el("productType")||{}).value || "Ø±ØµÙŠØ¯");

        if (!name || priceRaw === "" || !quantity || !imageUrl) {
          return alert("Ø£Ø¯Ø®Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„: Ø§Ù„Ø§Ø³Ù…ØŒ Ø§Ù„Ø³Ø¹Ø±ØŒ Ø§Ù„ÙƒÙ…ÙŠØ©ØŒ Ø§Ù„ØµÙˆØ±Ø©.");
        }

        const price = Math.round(parseFloat(priceRaw || 0) * 100) / 100;

        await setDoc(doc(db, "products", Date.now().toString()), {
          name,
          price,
          quantity,
          image: imageUrl,
          type, // Ø­ÙØ¸ Ù†ÙˆØ¹ Ø§Ù„Ù…Ù†ØªØ¬
          createdAt: new Date()
        });

        alert("ØªÙ… Ù†Ø´Ø± Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­!");
        if (el("productName")) el("productName").value = "";
        if (el("productPrice")) el("productPrice").value = "";
        if (el("productQuantity")) el("productQuantity").value = "";
        if (el("productImageUrl")) el("productImageUrl").value = "";
        if (el("productType")) el("productType").value = "Ø±ØµÙŠØ¯";
        await loadProducts();
      } catch (err) {
        console.error("publishProduct error:", err);
        alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù†Ø´Ø± Ø§Ù„Ù…Ù†ØªØ¬.");
      }
    }

    function openAdminPanel() {
      const adminModal = el("adminModal");
      if (!adminModal) return;
      adminModal.style.display = "flex";
    }
    function closeAdminPanel() {
      const adminModal = el("adminModal");
      if (!adminModal) return;
      adminModal.style.display = "none";
    }

    function logout() {
      signOut(auth).then(() => location.reload()).catch(err => console.error("logout error:", err));
    }

    function initUI() {
      el("loginBtn")?.addEventListener("click", ()=> login(el("loginEmail").value, el("loginPassword").value));
      el("registerBtn")?.addEventListener("click", ()=> register(el("registerEmail").value, el("registerPassword").value));
      el("logoutBtn")?.addEventListener("click", logout);
      el("searchBtnModal")?.addEventListener("click", ()=> searchUser(el("searchInput").value));
      el("publishBtn")?.addEventListener("click", publishProduct);
      el("closeAdminBtn")?.addEventListener("click", closeAdminPanel);

      const sideMenu = el("sideMenu");
      const overlay = el("sideMenuOverlay");
      el("menuBtn")?.addEventListener("click", ()=>{
        if(sideMenu){
          sideMenu.style.display="block";
          requestAnimationFrame(()=> sideMenu.classList.add("active"));
        }
        if(overlay){
          overlay.classList.add("active");
        }
      });
      el("closeMenu")?.addEventListener("click", ()=>{
        if(sideMenu){
          sideMenu.classList.remove("active");
          setTimeout(()=>{ sideMenu.style.display="none"; }, 340);
        }
        if(overlay){
          overlay.classList.remove("active");
        }
      });
      if(overlay){
        overlay.addEventListener("click", ()=>{
          el("closeMenu").click();
        });
      }

      el("sideOrders")?.addEventListener("click", ()=>{
        el('ordersPanel').style.display = "block";
        el('userPanel').style.display = "none";
        loadUserOrders();
        if (el("adminOrdersPanel")) el("adminOrdersPanel").style.display = "none";
      });

      el("sideProducts")?.addEventListener("click", ()=>{
        el('ordersPanel').style.display = "none";
        el('userPanel').style.display = "block";
        if (el("adminOrdersPanel")) el("adminOrdersPanel").style.display = "none";
      });

      el("adminOrdersBtn")?.addEventListener("click", ()=>{
        el('adminOrdersPanel').style.display = "block";
        el('ordersPanel').style.display = "none";
        el('userPanel').style.display = "none";
        loadAdminOrders();
      });

      const profileImg = el("sideProfileImg");
      const editProfileModal = el("editProfileModal");
      el("cancelEditProfileBtn")?.addEventListener("click", ()=> { if(editProfileModal) editProfileModal.style.display="none"; });
      if (profileImg && editProfileModal) profileImg.onclick = ()=> editProfileModal.style.display = "flex";
      el("saveProfileBtn")?.addEventListener("click", async ()=> {
        try {
          const uid = auth.currentUser ? auth.currentUser.uid : null;
          if (!uid) return alert("Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹.");
          const newName = (el("profileNameInput")||{}).value || "";
          const newPhoto = (el("profileImgInput")||{}).value || "";
          if (!newName && !newPhoto) return alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø£Ùˆ Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø©.");
          const updates = {};
          if (newName) updates.name = newName;
          if (newPhoto) updates.photoURL = newPhoto;
          await updateDoc(doc(db, "users", uid), updates);
          await loadUserData(uid, auth.currentUser ? auth.currentUser.email : "");
          if(editProfileModal) editProfileModal.style.display = "none";
        } catch (err) {
          alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ.");
        }
      });

      initEditName();
    }

    onAuthStateChanged(auth, async (user) => {
      const authPanel = el("authPanel");
      const userPanel = el("userPanel");
      const topBar = el("topBar");
      if (user) {
        if (authPanel) authPanel.style.display = "none";
        if (userPanel) userPanel.style.display = "block";
        if (topBar) topBar.style.display = "flex";
        await loadUserData(user.uid, user.email);
        await loadProducts();
        await loadUserOrders();
      } else {
        if (authPanel) authPanel.style.display = "block";
        if (userPanel) userPanel.style.display = "none";
        if (topBar) topBar.style.display = "none";
        if (el("ordersPanel")) el("ordersPanel").style.display = "none";
        if (el("adminOrdersPanel")) el("adminOrdersPanel").style.display = "none";
      }
    });

    window.addEventListener("DOMContentLoaded", () => {
      initUI();
      window.openAdminPanel = openAdminPanel;
      window.closeAdminPanel = closeAdminPanel;
      window.publishProduct = publishProduct;
      window.loadProducts = loadProducts;
      window.buyProduct = buyProduct;
      window.searchUser = searchUser;
      window.logout = logout;
    });
  </script>
</body>
</html>


